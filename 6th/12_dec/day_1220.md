

[サイボウズ・ラボユース日時報告書]
---------------------------------------------------------------------------
勤務日：2016年12月20日火曜日
報告者：城倉弘樹
---------------------------------------------------------------------------
###■ 開発プロジェクト名
 slankdev/stcp.git


###■ 今日の目標

 - テスト用アプリケーションで速度パフォーマンス計測


###■ 作業実績 (実際にかかった時間を書いてください)

 - 10:00-11:00 パフォーマンス計測方法のテスト
 - 11:00-14:00 実験方法検討
    - どのパラメータをイジるかを調べる
	- そもそもどこまでイジれるかを調べる


###■ 達成度

80%

 - 「iperfをloに行うとCPUのパケット処理性能が簡単にわかるよ」 (後述1)
    僕てきには興味深い結果がでました。
	STCPもマルチコアサポートな実装にしなくては
 - CPUクロック速度を固定する方法が成功しなかった(cpupowerを使用)
   ドライバ関係で問題がありそうなので、引き続きしらべる


###■ 後述1: iperfによるパケット処理性能

「iperfをloに行うとCPUのパケット処理性能が簡単にわかるよ」 (後述1)
とあったのでやってみた -> 48.3Gbps!!! 星野さんマシンつよい。。
ちなみに僕のMBP -> 53.5Gbps!!!? -> ふぁ？ふぁ？ってことでもうすこししらべてみた

単純な処理性能はこの程度(1client)だと限界が見えていない模様 -> 多数クライアントで
やってみた.

1 client
 - MacBookPro    : 49.6Gbps
 - HoshinoMachine: 49.1Gbps

8 clients
 - MacBookPro    :  7.4Gbps/client, SUM=51.5Gbps
 - HoshinoMachine: 15.6Gbps/client, SUM=123Gbps !! -> すごい!!!

単純なひかくとしてHoshinoMachineとMBPはコア数の違いがいちばん大きいから
マルチコアスケールしているっていうのがHoshinoMachineの勝因だと思われる

とりあえずここからわかることとしてloをうまく使えば、NICを用意しなくても
perf計測ができそう...ならやるしかない! -> 明日の予定にする

参考: http://www.slideshare.net/masaruoki9/xeon-d



###■ 問題点,原因,対策 (それぞれ1,2,3で分けて書く)

とくになし.



###■ 明日以降の予定

 - cpupowerで設定変更をできるようにする
 - loを使ってパフォーマンス計測ができないか検討
   まえにうまくいかなかったのでリベンジ



###■ 作業リポジトリ履歴

 - DPDKテスト環境について
   https://github.com/slankdev/stcp/blob/master/doc/perfotmance/test_1220.md


ほかはとくにありません。
明日の報告で紙に書いた内容を説明します。

---------------------------------------------------------------------------


