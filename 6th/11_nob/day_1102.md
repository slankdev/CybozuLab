

[サイボウズ・ラボユース日時報告書]
---------------------------------------------------------------------------
勤務日：2016年11月02日水曜日
報告者：城倉弘樹
---------------------------------------------------------------------------
###■ 開発プロジェクト名
 slankdev/stcp.git


###■ 今日の目標

 - ESTABLISH時にFINをうけとった時のちゃんとした挙動について未実装
 - 現在のストリームとは関係ないパケットが来たときの挙動が未実装
 - RSTパケットが着たときの挙動が未実装




###■ 作業実績 (実際にかかった時間を書いてください)

 - 10:00-11:30 BSDの実装をみて全体の構造を理解 -> STCPとはだいぶ違う
     - BSD実装では非同期処理をたくさんしているっぽいので、
	   STCPとはだいぶ違くなってしまった
	 - でもとりあえず、STCPを完成させるところまでやることにしている
 - 11:00-13:00 ESTABLISH時にFINをうけとった時のちゃんとした挙動について実装->完了!
 - 13:00-14:00 今後の実装のためのリファクタリング



###■ 達成度


70%

 - コネクション関係はほぼ完成状態だと思う



###■ 問題点,原因,対策 (それぞれ1,2,3で分けて書く)

 - 進捗としてはよかったが目標設定が厳しすぎた。



###■ 明日以降の予定

 - [ ] リファクタリング作業
 - [ ] socketに対して送受信キューを用意する
 - [ ] listen実装
 - [ ] acceptの実装 (tcp stream確立部分, ソケットを新たに生成する)
 - [x] データ受信時のack処理の実装
 - [ ] TCPフラグメント APIの実装 (DPDKに追加する)
      - データを貯めておくバッファの実装
      - データを並べ替えて正しい順番にしておく機能の実装
 - [ ] 上を使用してフラグメントをゼロコピーで実装
 - [ ] アプリケーションのプロセスを別のスレッドで動かす
      - tcp_usrreq_XXXX()を用意する -> BSDを参考にする
 - [x] ESTABLISH時にFINをうけとった時のちゃんとした挙動について未実装
 - [ ] 現在のストリームとは関係ないパケットが来たときの挙動が未実装
 - [ ] RSTパケットが着たときの挙動が未実装
 - [ ] windowサイズの更新をするための挙動が未実装
 - [ ] windowサイズ関連全般がだめ, まだてをつけていない
 - [ ] clk->msのdiff関数

###■ 作業リポジトリ履歴


slankdev/stcp.git
 - [REFACT]
   http://github.com/slankdev/stcp/commit/f84129ffed7dd180e894757f5d3906c34d5e8581
 - [MODIFY] behaviour to recv FINACK correctly
   http://github.com/slankdev/stcp/commit/308d9c38481775191704a7adebd24224f29d9f82
 - [DEL] comment
   http://github.com/slankdev/stcp/commit/c011930de62f9a81d80e4c08ae9e1eff8aa7e1c7
 - [RENAME] enums about tcp state
   http://github.com/slankdev/stcp/commit/aa8f13d8ed5fc6e330d6cae6e09d309a23b1520c



---------------------------------------------------------------------------
