

[サイボウズ・ラボユース日時報告書]
---------------------------------------------------------------------------
勤務日：2016年11月08日火曜日
報告者：城倉弘樹
---------------------------------------------------------------------------
###■ 開発プロジェクト名
 slankdev/stcp.git


###■ 今日の目標

 - TCPの実装 7h
    - RSTパケットが着たときの挙動が未実装
    - listen実装
    - acceptの実装 (tcp stream確立部分, ソケットを新たに生成する)

没
 - socketに対して送受信キューを用意する


###■ 作業実績 (実際にかかった時間を書いてください)

 - 10:00-11:00 RSTパケットの処理を実装 -> 今後実装しやすいように変更
 - 11:00-13:30 listen実装
     - 新しいconnectがあった場合にsocketを新たに確保してそのconnectとつなげる
 - 13:30-14:30 お昼休み
 - 14:00-16:30 listen,acceptの実装
 - 16:30-18:00 マルチスレッド実装についての調査


###■ 達成度

50%

 - 複数クライアントに大してTCPコネクションをつなげるようになった
 - コードがぐちゃぐちゃなので、次の実装をする前にたくさん時間をつかって、
   各コンポーネントの関係などを整理する必要がある。 -> 時間を惜しまずやること!
 - DPDKで効率よくマルチスレッドを動かす方法を検討するので、
   またしばらくドキュメントと格闘することになりそう.

###■ 問題点,原因,対策 (それぞれ1,2,3で分けて書く)

シングルスレッドでTCPのアプリケーションを書くインターフェースを用意する
(STCPの処理と同時進行でアプリを動かして、socketAPIに近いインターフェースを提供する)
のは難しいため、ユーザアプリケーション部分はSTCPとは別のスレッドで動かすことにした

論理コアに対する関数のspawnは出きるが、動かしたいスレッドが論理コア数より多くなった場合に
対応できるようにするために情報収集をしていたが、終わらなかった。


###■ 明日以降の予定

 - マルチスレッド化方法の検討, 設計
 - 実装するまえに全体の整理(メモの整理)とリファクタリング


###■ 作業リポジトリ履歴

slankdev/stcp.git
 - [IMPLE] listen() maybe have problem
   http://github.com/slankdev/stcp/commit/d8a4031476817b877e90abca2f36f25bf112a13b
 - [RENAME] check_RST -> do_RST
   http://github.com/slankdev/stcp/commit/d496e1e945db03a04af28403c0a1287013c0f539


DPDKドキュメント
 - http://dpdk.org/doc/guides-16.07/prog_guide/multi_proc_support.html
 - http://dpdk.org/doc/api/rte__launch_8h.html#a83b0efa9e30a74217e7a95956845e2ad

---------------------------------------------------------------------------
