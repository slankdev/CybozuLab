

[サイボウズ・ラボユース日時報告書]
---------------------------------------------------------------------------
勤務日：2016年11月29日火曜日
報告者：城倉弘樹
---------------------------------------------------------------------------
###■ 開発プロジェクト名
 slankdev/stcp.git


###■ 今日の目標

 - 書き換え部分の修正, 動作確認 2h


###■ 作業実績 (実際にかかった時間を書いてください)

 - 10:00-11:15 構成確認
 - 11:15-12:00 まとめなど

目標と違うように見えますが、書き換え部分の修正のための準備作業です。


###■ 達成度

50%

 - 紙媒体:[TCP受信処理]にまとめた。

決まりごと
 - サブルーチンに渡すタイミングでmbufをクローンすることにする (例参照)
 - 今後mbuf_cloneでどれだけ遅延が起きるかを確認しておく必要がありそう
 - txまたはfreeの関数によってmbufは開放される。 (alloc/clone/rx <--> free/tx)


例
```
void main()
	mbuf* m = pop();
	subroutine(clone(m));
	free(m);

void subroutine(mbuf* m)
	free(m);
```

lock_guardクラスみたいなアイディアを使えばfreeし忘れしないように実装できそう。
今後考えよう.


ちょっとずつ頭が整理できてきた気がしたのでメモ

作業のプロセスの変化

C++を光成さんから学ぶまえ

 - 親問題を分割して子問題にする
 - 順番に子問題を解決 (再帰
 - 子問題を解決する

C++を光成さんから学び初めてから

 - 親問題を分割して子問題にする
 - 順番に子問題を解決 (再帰)
 - 問題を解決するときにミスが出ないようにクラスを設計する
   アンロックし忘れとかfreeし忘れとかが起きないためのクラス設計
 - 子問題を解決する

クラス設計とか(言語設計レベルでもかな。。)でプログラマのミスをなくすような
取り組みができる

当たり前のことですが、最近やっと上記に関してはすっきりしてきました。

5月ごろに「最初にクラス設計とかに時間がかかって面倒くさい」と思ってましたが、
freeし忘れの管理などで大幅に楽になることも実感しました。


###■ 問題点,原因,対策 (それぞれ1,2,3で分けて書く)

 - 12月中がいろいろと予定が入ってしまっていてお休みをしなくてはいけない日が
   多そうなので、短時間で進捗を出せるようにしよう。
 - だいぶ内容的には出来上がってきているのでラストスパート!


###■ 明日以降の予定

 - 書き換え部分の修正, 動作確認 2h
 - 次回以降の日報では継承と保持についてのまとめも作成する


###■ 作業リポジトリ履歴

 - TCPの実装に関するメモ
   https://gist.github.com/slankdev/63afb92b56602f45144bc117eabb697b

STCPのコードは本日はいじっていないので、コミットがありません。

---------------------------------------------------------------------------


