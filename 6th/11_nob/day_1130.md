

[サイボウズ・ラボユース日時報告書]
---------------------------------------------------------------------------
勤務日：2016年11月30日水曜日
報告者：城倉弘樹
---------------------------------------------------------------------------
###■ 開発プロジェクト名
 slankdev/stcp.git


###■ 今日の目標

 - 全体の修正, リファクタリング 4h

###■ 作業実績 (実際にかかった時間を書いてください)

 - 10:00-14:00 環境依存部分の抽象化作業


###■ 達成度

100%

 - 大きな修正はしていないが、ディレクトリ構造など、だいぶ整理できた。
 - 環境依存な部分を抽象化したい。(DPDKがなくても動かせるように)
   そのように実装した場合、ethernetドライバと最低限度の機能があれば
   自作OSとかでも動かせるようになる

 - 環境依存なコンポーネント
     - mbuf
	 - interface ctrl
	     - packet IO
		 - count device
     - cpu info
		 - rdtsc/tsc_hz
		 - ntoh/hton
		 - cpu socket_id
	 - rand/srand
	 - malloc/free/memory pool


###■ 問題点,原因,対策 (それぞれ1,2,3で分けて書く)

 - とくになし


###■ 明日以降の予定

次回勤務
 - socketの設計改善
 - デバッグ/テストをしやすいように情報表示部分を調整


勤務時間外
 - 環境依存に対する抽象化作業　
	 - mempoolをラップする
	 - mbufをラップする
 - mbufクローンはC++ポインタクラス使って安全に書き直そう
 - dpdkの関数のラップ関数をinlineにする


とりあえずこれ以上は進めない予定
 - [ ] マルチプロセッサ向けの実装を追加するための情報収集
 - [ ] シグナルコンディション変数を使ったpollを実装する
 - [ ] ソケット関連の設計を改善 -> これはすぐには取りかからない
 - [ ] accept待ちのソケットのキューをグローバルスコープ(ソケットクラス外部)に置く
      - [ ] ソケットの実態をまとめて管理 ポインタのベクタで管理するのを変更する
 - [ ] 固定長のソケットプールを用意する
 - [ ] newを使った実装を避ける



###■ 作業リポジトリ履歴


slankdev/stcp.git
 - [REFACT]
   http://github.com/slankdev/stcp/commit/0e11576514323de6a42c70437b5143b86014a862
 - [ADD] arch
   http://github.com/slankdev/stcp/commit/482a1b3a2f2d364745322a8eeb3f6554156728bd
 - [ADD] Util function
   http://github.com/slankdev/stcp/commit/17f23063d3a134f805c1cddce342c588453e4cab


---------------------------------------------------------------------------
